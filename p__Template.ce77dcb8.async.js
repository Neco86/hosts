(self.webpackChunktest=self.webpackChunktest||[]).push([[974,371],{75941:function(N){N.exports={wrapper:"wrapper___3iih1",config:"config___1jRLL",workArea:"workArea___3Z94m",input:"input___3IKyb",btn:"btn___h4QN4",parseResult:"parseResult___2m4fz",row:"row___35U44",templateInput:"templateInput___3qfFR",errInput:"errInput___2Sb3-",table:"table___3-dMD"}},49460:function(N){N.exports={wrapper:"wrapper___Vm4He",content:"content___17Qxt",row:"row___I2bgO"}},53759:function(N,Z){"use strict";Z.Z=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"index",te="https://neco86.github.io/templateReport/config/".concat(e,".json?t=").concat(Date.now());return fetch(te).then(function($){return $.json()})}},50131:function(N,Z,e){"use strict";e.r(Z),e.d(Z,{MOMENT_REGEXP:function(){return b},default:function(){return X}});var te=e(59319),$=e(34866),xe=e(63185),ae=e(9676),ne=e(57663),E=e(27884),ce=e(34792),F=e(0),p=e(86582),g=e(2824),de=e(47673),J=e(20086),re=e(75941),c=e.n(re),a=e(67294),w=e(7869),G=e.n(w),le=e(30381),B=e.n(le);function j(v){for(var f=new ArrayBuffer(v.length),l=new Uint8Array(f),s=0;s<v.length;s++)l[s]=v.charCodeAt(s)&255;return f}function d(v){var f=G().write({SheetNames:["sheet1"],Sheets:{sheet1:v}},{bookType:"xlsx",bookSST:!1,type:"binary"}),l=new Blob([j(f)],{type:"application/octet-stream"});return l}function h(v){var f=d(v),l=URL.createObjectURL(f),s=document.createElement("a");s.href=l,s.download="".concat(B()().format("YYYY_MM_DD"),".xlsx"),s.innerText="".concat(B()().format("YYYY_MM_DD"),".xlsx"),s.click(),URL.revokeObjectURL(l)}var m=e(53759),n=e(85893),R=J.Z.TextArea,T=w.utils.table_to_sheet,b=/MOMENT\(.+\)/g,L="TEMPLATE_CONFIG",H="TEMPLATE_AUTO",ue=function v(f){return f.map(function(l){return{title:l.title.replace(b,function(s){return B()().format(s.slice(7,s.length-1))}),dataIndex:l.dataIndex,sorter:l.sorter?function(s,U){var C,D;return s[(C=l==null?void 0:l.dataIndex)!==null&&C!==void 0?C:0]-U[(D=l==null?void 0:l.dataIndex)!==null&&D!==void 0?D:0]}:void 0,children:l.children?v(l.children):void 0}})},X=function(){var v=(0,a.useState)([]),f=(0,g.Z)(v,2),l=f[0],s=f[1],U=(0,a.useState)(""),C=(0,g.Z)(U,2),D=C[0],se=C[1],oe=(0,a.useState)([]),Q=(0,g.Z)(oe,2),u=Q[0],o=Q[1],I=(0,a.useState)(!!localStorage.getItem(H)),x=(0,g.Z)(I,2),y=x[0],Y=x[1],V=(0,a.useState)(""),ve=(0,g.Z)(V,2),W=ve[0],me=ve[1],Se=(0,a.useState)([]),fe=(0,g.Z)(Se,2),q=fe[0],Ce=fe[1],Ie=(0,a.useState)([]),pe=(0,g.Z)(Ie,2),ye=pe[0],ie=pe[1],Te=(0,a.useState)([]),he=(0,g.Z)(Te,2),Me=he[0],Oe=he[1],_e=(0,a.useRef)(),Ee=(0,a.useMemo)(function(){return u.length},[u]),M=(0,a.useMemo)(function(){return(0,p.Z)(new Array(Ee)).map(function(){return""})},[Ee]),Ae=(0,a.useState)(M),ge=(0,g.Z)(Ae,2),O=ge[0],ee=ge[1],Pe=(0,a.useMemo)(function(){return D.split(`
`).filter(Boolean).map(function(t){return t.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(r){return/\$\{[0-9]+\}/.test(r)?{type:"input",dataIndex:+r.slice(2,r.length-1)}:{type:"text",value:r}})})},[D]),Re=(0,a.useCallback)(function(t){return function(r){ee(M.map(function(i,S){var _;return S===t?r.target.value:(_=O==null?void 0:O[S])!==null&&_!==void 0?_:""}))}},[O,M]),be=(0,a.useCallback)(function(){Ce([].concat((0,p.Z)(q),[O])),me(""),ee(M),ie([]),_e.current.focus()},[q,M,O]),z=(0,a.useCallback)(function(){ee(M),ie([])},[M]),k=(0,a.useCallback)(function(t){var r=(0,p.Z)(M),i=[];u.forEach(function(S,_){var A,P;r[_]=(A=(P=t.replace(/\s/g,"").match(S))===null||P===void 0?void 0:P[1])!==null&&A!==void 0?A:"",r[_]||i.push(_)}),ee(r),ie(i)},[M,u]),De=(0,a.useCallback)(function(){var t=T(document.getElementById("table"));h(t)},[]),Ze=(0,a.useCallback)(function(t){var r=t.target.checked;Y(r),r?(localStorage.setItem(H,"1"),z(),W&&k(W)):localStorage.removeItem(H)},[z,k,W]),je=(0,a.useCallback)(function(t){var r=t.target.value;me(r),y&&(z(),r&&k(r))},[y,z,k]),K=(0,a.useCallback)(function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!t||!t.wordTemplate||!t.columns||!t.parseRules?(F.default.error("\u914D\u7F6E\u6587\u4EF6\u4E0D\u6B63\u786E!"),localStorage.removeItem(L)):(localStorage.setItem(L,JSON.stringify(t)),se(t.wordTemplate.replace(b,function(i){return B()().format(i.slice(7,i.length-1))})),s(ue(t.columns)),o(t.parseRules.map(function(i){return new RegExp(i)})),r||F.default.success("\u5BFC\u5165\u914D\u7F6E\u6210\u529F!"))},[]),Ne=(0,a.useCallback)(function(){var t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=function(r){var i,S,_=r==null||(i=r.target)===null||i===void 0||(S=i.files)===null||S===void 0?void 0:S[0];if(_){var A=new FileReader;A.onload=function(){var P=A.result;try{var Le=JSON.parse(P);K(Le)}catch(Ue){F.default.error("\u914D\u7F6E\u4E0D\u6B63\u786E!")}},A.readAsText(_,"UTF-8")}},t.click()},[K]);(0,a.useEffect)(function(){(0,m.Z)().then(function(t){var r=t.list;Oe(r)})},[]);var Be=(0,a.useCallback)(function(t){(0,m.Z)(t).then(K)},[K]);return(0,a.useEffect)(function(){try{var t=JSON.parse(localStorage.getItem(L));t&&K(t,!0)}catch(r){localStorage.removeItem(L)}},[K]),(0,n.jsxs)("div",{className:c().wrapper,children:[(0,n.jsxs)("div",{className:c().config,children:[(0,n.jsx)(E.Z,{size:"small",onClick:Ne,children:"\u5BFC\u5165\u914D\u7F6E"}),Me.map(function(t){var r=t.name,i=t.fileName;return(0,n.jsx)(E.Z,{size:"small",onClick:function(){return Be(i)},children:r},i)})]}),(0,n.jsxs)("div",{className:c().workArea,children:[(0,n.jsx)(R,{ref:_e,autoFocus:!0,className:c().input,value:W,onChange:je}),(0,n.jsxs)("div",{children:[(0,n.jsx)(E.Z,{className:c().btn,size:"small",type:"primary",onClick:function(){return k(W)},disabled:!W,children:"\u89E3\u6790\u2192"}),(0,n.jsx)(ae.Z,{className:c().btn,checked:y,onChange:Ze,children:"\u81EA\u52A8\u2192"})]}),(0,n.jsxs)("div",{className:c().parseResult,children:[Pe.map(function(t,r){return(0,n.jsx)("div",{className:c().row,children:t.map(function(i,S){var _=i.type,A=i.value,P=i.dataIndex;return(0,n.jsxs)(a.Fragment,{children:[_==="input"&&(0,n.jsx)(J.Z,{value:O[P],onChange:Re(P),className:"".concat(c().templateInput," ").concat(ye.includes(P)&&c().errInput),size:"small"}),_==="text"&&A]},"".concat(r,"_").concat(S))})},r)}),(0,n.jsxs)("div",{className:c().row,children:[(0,n.jsx)(E.Z,{size:"small",type:"primary",onClick:be,disabled:!O.filter(Boolean).length,children:"\u786E\u8BA4"}),(0,n.jsx)(E.Z,{size:"small",type:"primary",danger:!0,onClick:z,disabled:!O.filter(Boolean).length,children:"\u6E05\u7A7A"})]})]})]}),(0,n.jsx)(E.Z,{className:c().btn,size:"small",type:"primary",disabled:!q.length,onClick:De,children:"\u5BFC\u51FA"}),(0,n.jsx)($.Z,{id:"table",className:c().table,columns:l,dataSource:q,bordered:!0,pagination:!1})]})}},49506:function(N,Z,e){"use strict";e.r(Z);var te=e(57663),$=e(27884),xe=e(47673),ae=e(20086),ne=e(86582),E=e(2824),ce=e(30381),F=e.n(ce),p=e(67294),g=e(27905),de=e(50131),J=e(53759),re=e(49460),c=e.n(re),a=e(85893),w=function(d){var h="TEMPLATE_INPUT_HISTORY_".concat(d),m=localStorage.getItem(h);if(m)try{var n=JSON.parse(m);return n}catch(R){localStorage.removeItem(h)}},G=function(d,h){var m="TEMPLATE_INPUT_HISTORY_".concat(d);localStorage.setItem(m,JSON.stringify(h))},le=function(d){var h=[],m=function n(R){R.forEach(function(T){h.push(T),T.children&&n(T.children)})};return m(d),h},B=function(d,h){var m,n,R=le(d);return(m=(n=R.find(function(T){var b=T.dataIndex;return+b===h}))===null||n===void 0?void 0:n.title)!==null&&m!==void 0?m:""};Z.default=function(){var j=(0,g.UO)(),d=j.configFileName,h=(0,p.useState)(""),m=(0,E.Z)(h,2),n=m[0],R=m[1],T=(0,p.useState)([]),b=(0,E.Z)(T,2),L=b[0],H=b[1],ue=(0,p.useState)([]),X=(0,E.Z)(ue,2),v=X[0],f=X[1],l=(0,p.useState)({title:"\u590D\u5236",disabled:!1}),s=(0,E.Z)(l,2),U=s[0],C=s[1],D=(0,p.useMemo)(function(){return n.split(`
`).filter(Boolean).map(function(u){return u.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(o){return/\$\{[0-9]+\}/.test(o)?{type:"input",dataIndex:+o.slice(2,o.length-1)}:{type:"text",value:o}})})},[n]),se=(0,p.useCallback)(function(u){R(u.wordTemplate.replace(de.MOMENT_REGEXP,function(x){return F()().format(x.slice(7,x.length-1))}));var o=w(d);if((o==null?void 0:o.length)===u.parseRules.length)f(o);else{var I=(0,ne.Z)(new Array(u.parseRules.length)).map(function(){return""});f(I),G(d,I)}H((0,ne.Z)(new Array(u.parseRules.length)).map(function(x,y){return B(u.columns,y)}))},[d]);(0,p.useEffect)(function(){(0,J.Z)(d).then(se).catch(function(){C({title:"\u914D\u7F6E\u4E0D\u5B58\u5728!",disabled:!0})})},[d]);var oe=(0,p.useCallback)(function(){var u=document.createElement("textarea");document.body.appendChild(u),u.value=n.replace(/(\$\{[0-9]+\})/g,function(o){return v[+o.slice(2,o.length-1)]}),u.select(),document.execCommand("copy"),document.body.removeChild(u),C({title:"\u590D\u5236\u6210\u529F!",disabled:!0}),setTimeout(function(){C({title:"\u590D\u5236",disabled:!1})},1e3)},[v,n]),Q=(0,p.useCallback)(function(u){return function(o){var I=o.target.value,x=v.map(function(y,Y){return Y===u?I:y});f(x),G(d,x)}},[v,d]);return(0,a.jsxs)("div",{className:c().wrapper,children:[(0,a.jsx)("div",{className:c().content,children:D.map(function(u,o){return(0,a.jsx)("div",{className:c().row,children:u.map(function(I,x){var y=I.type,Y=I.value,V=I.dataIndex;return(0,a.jsxs)(p.Fragment,{children:[y==="input"&&(0,a.jsx)(ae.Z,{value:v[V],onChange:Q(V),size:"small",placeholder:L[V]}),y==="text"&&Y]},"".concat(o,"_").concat(x))})},o)})}),(0,a.jsx)($.Z,{type:"primary",disabled:U.disabled,onClick:oe,children:U.title})]})}},18685:function(){},20067:function(){},55382:function(){},72095:function(){},61219:function(){}}]);
