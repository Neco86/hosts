(self.webpackChunktest=self.webpackChunktest||[]).push([[371],{75941:function(M){M.exports={wrapper:"wrapper___3iih1",config:"config___1jRLL",workArea:"workArea___3Z94m",input:"input___3IKyb",btn:"btn___h4QN4",parseResult:"parseResult___2m4fz",row:"row___35U44",templateInput:"templateInput___3qfFR",errInput:"errInput___2Sb3-",table:"table___3-dMD"}},66635:function(M,F,n){"use strict";n.r(F),n.d(F,{default:function(){return ue}});var $e=n(59319),Q=n(34866),ke=n(63185),W=n(9676),Me=n(57663),g=n(27884),Fe=n(34792),R=n(0),E=n(86582),f=n(2824),Be=n(47673),B=n(20086),X=n(75941),o=n.n(X),a=n(67294),w=n(7869),q=n.n(w),_=n(30381),j=n.n(_);function ee(i){for(var c=new ArrayBuffer(i.length),l=new Uint8Array(c),s=0;s<i.length;s++)l[s]=i.charCodeAt(s)&255;return c}function te(i){var c=q().write({SheetNames:["sheet1"],Sheets:{sheet1:i}},{bookType:"xlsx",bookSST:!1,type:"binary"}),l=new Blob([ee(c)],{type:"application/octet-stream"});return l}function ae(i){var c=te(i),l=URL.createObjectURL(c),s=document.createElement("a");s.href=l,s.download="".concat(j()().format("YYYY_MM_DD"),".xlsx"),s.innerText="".concat(j()().format("YYYY_MM_DD"),".xlsx"),s.click(),URL.revokeObjectURL(l)}var z=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"index",c="https://neco86.github.io/templateReport/config/".concat(i,".json?t=").concat(Date.now());return fetch(c).then(function(l){return l.json()})},u=n(85893),ne=B.Z.TextArea,le=w.utils.table_to_sheet,D=/MOMENT\(.+\)/g,re=function i(c){return c.map(function(l){return{title:l.title.replace(D,function(s){return j()().format(s.slice(7,s.length-1))}),dataIndex:l.dataIndex,sorter:l.sorter?function(s,T){var S,v;return s[(S=l==null?void 0:l.dataIndex)!==null&&S!==void 0?S:0]-T[(v=l==null?void 0:l.dataIndex)!==null&&v!==void 0?v:0]}:void 0,children:l.children?i(l.children):void 0}})},ue=function(){var i=(0,a.useState)([]),c=(0,f.Z)(i,2),l=c[0],s=c[1],T=(0,a.useState)(""),S=(0,f.Z)(T,2),v=S[0],se=S[1],oe=(0,a.useState)([]),L=(0,f.Z)(oe,2),I=L[0],ie=L[1],ce=(0,a.useState)(!1),Y=(0,f.Z)(ce,2),$=Y[0],de=Y[1],ve=(0,a.useState)(""),U=(0,f.Z)(ve,2),C=U[0],O=U[1],fe=(0,a.useState)([]),P=(0,f.Z)(fe,2),Z=P[0],me=P[1],he=(0,a.useState)([]),V=(0,f.Z)(he,2),pe=V[0],k=V[1],H=(0,a.useRef)(),xe=(0,a.useMemo)(function(){return v.split(`
`).filter(Boolean).map(function(e){return e.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(t){return/\$\{[0-9]+\}/.test(t)?{type:"input",dataIndex:+t.slice(2,t.length-1)}:{type:"text",value:t}})})},[v]),G=(0,a.useMemo)(function(){var e,t;return((e=(t=v.split(/(\$\{[0-9]+\})/g).filter(function(r){return/\$\{[0-9]+\}/.test(r)}).map(function(r){return+r.slice(2,r.length-1)}).sort(function(r,d){return d-r}))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:-1)+1},[v]),x=(0,a.useMemo)(function(){return(0,E.Z)(new Array(G)).map(function(){return""})},[G]),ge=(0,a.useState)(x),J=(0,f.Z)(ge,2),y=J[0],A=J[1],Se=(0,a.useCallback)(function(e){return function(t){A(y.map(function(r,d){return d===e?t.target.value:r}))}},[y]),Ce=(0,a.useCallback)(function(){me([].concat((0,E.Z)(Z),[y])),O(""),A(x),k([]),H.current.focus()},[Z,x,y]),ye=(0,a.useCallback)(function(){A(x),k([])},[x]),b=(0,a.useCallback)(function(e){var t=(0,E.Z)(x),r=[];I.forEach(function(d,m){var h,p;t[m]=(h=(p=e.replace(/\s/g,"").match(d))===null||p===void 0?void 0:p[1])!==null&&h!==void 0?h:"",t[m]||r.push(m)}),A(t),k(r)},[x,I]),be=(0,a.useCallback)(function(){var e=le(document.getElementById("table"));ae(e)},[]),je=(0,a.useCallback)(function(e){var t=e.target.checked;de(t),t&&C&&b(C)},[b,C]),Ie=(0,a.useCallback)(function(e){var t=e.target.value;O(t),$&&t&&b(t)},[$,b]),N=(0,a.useCallback)(function(e){!e||!e.wordTemplate||!e.columns||!e.parseRules?R.default.error("\u914D\u7F6E\u6587\u4EF6\u4E0D\u6B63\u786E!"):(se(e.wordTemplate.replace(D,function(t){return j()().format(t.slice(7,t.length-1))})),s(re(e.columns)),ie(e.parseRules.map(function(t){return new RegExp(t)})),R.default.success("\u5BFC\u5165\u914D\u7F6E\u6210\u529F!"))},[]),Ze=(0,a.useCallback)(function(){var e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=function(t){var r,d,m=t==null||(r=t.target)===null||r===void 0||(d=r.files)===null||d===void 0?void 0:d[0];if(m){var h=new FileReader;h.onload=function(){var p=h.result;try{var Te=JSON.parse(p);N(Te)}catch(we){R.default.error("\u914D\u7F6E\u4E0D\u6B63\u786E!")}},h.readAsText(m,"UTF-8")}},e.click()},[N]),Ae=(0,a.useState)([]),K=(0,f.Z)(Ae,2),Ne=K[0],Re=K[1];(0,a.useEffect)(function(){z().then(function(e){var t=e.list;Re(t)})},[]);var Ee=(0,a.useCallback)(function(e){z(e).then(N)},[N]);return(0,u.jsxs)("div",{className:o().wrapper,children:[(0,u.jsxs)("div",{className:o().config,children:[(0,u.jsx)(g.Z,{size:"small",onClick:Ze,children:"\u5BFC\u5165\u914D\u7F6E"}),Ne.map(function(e){var t=e.name,r=e.fileName;return(0,u.jsx)(g.Z,{size:"small",onClick:function(){return Ee(r)},children:t},r)})]}),(0,u.jsxs)("div",{className:o().workArea,children:[(0,u.jsx)(ne,{ref:H,autoFocus:!0,className:o().input,value:C,onChange:Ie}),(0,u.jsxs)("div",{children:[(0,u.jsx)(g.Z,{className:o().btn,size:"small",type:"primary",onClick:function(){return b(C)},disabled:!C,children:"\u89E3\u6790\u2192"}),(0,u.jsx)(W.Z,{className:o().btn,checked:$,onChange:je,children:"\u81EA\u52A8\u2192"})]}),(0,u.jsxs)("div",{className:o().parseResult,children:[xe.map(function(e,t){return(0,u.jsx)("div",{className:o().row,children:e.map(function(r,d){var m=r.type,h=r.value,p=r.dataIndex;return(0,u.jsxs)(a.Fragment,{children:[m==="input"&&(0,u.jsx)(B.Z,{value:y[p],onChange:Se(p),className:"".concat(o().templateInput," ").concat(pe.includes(p)&&o().errInput),size:"small"}),m==="text"&&h]},"".concat(t,"_").concat(d))})},t)}),(0,u.jsxs)("div",{className:o().row,children:[(0,u.jsx)(g.Z,{size:"small",type:"primary",onClick:Ce,disabled:!v||!I.length,children:"\u786E\u8BA4"}),(0,u.jsx)(g.Z,{size:"small",type:"primary",danger:!0,onClick:ye,disabled:!v||!I.length,children:"\u6E05\u7A7A"})]})]})]}),(0,u.jsx)(g.Z,{className:o().btn,size:"small",type:"primary",disabled:!Z.length,onClick:be,children:"\u5BFC\u51FA"}),(0,u.jsx)(Q.Z,{id:"table",className:o().table,columns:l,dataSource:Z,bordered:!0,pagination:!1})]})}},18685:function(){},20067:function(){},55382:function(){},72095:function(){},61219:function(){}}]);
