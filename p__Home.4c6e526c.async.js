(self.webpackChunktest=self.webpackChunktest||[]).push([[371],{75941:function(M){M.exports={wrapper:"wrapper___3iih1",config:"config___1jRLL",workArea:"workArea___3Z94m",input:"input___3IKyb",btn:"btn___h4QN4",parseResult:"parseResult___2m4fz",row:"row___35U44",templateInput:"templateInput___3qfFR",errInput:"errInput___2Sb3-",table:"table___3-dMD"}},53759:function(M,A){"use strict";A.Z=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"index",z="https://neco86.github.io/templateReport/config/".concat(n,".json?t=").concat(Date.now());return fetch(z).then(function(k){return k.json()})}},50131:function(M,A,n){"use strict";n.r(A),n.d(A,{MOMENT_REGEXP:function(){return F},default:function(){return ce}});var z=n(59319),k=n(34866),Be=n(63185),ee=n(9676),Fe=n(57663),x=n(27884),Oe=n(34792),L=n(0),B=n(86582),f=n(2824),$e=n(47673),D=n(20086),te=n(75941),o=n.n(te),a=n(67294),P=n(7869),ae=n.n(P),ne=n(30381),Z=n.n(ne);function re(c){for(var d=new ArrayBuffer(c.length),r=new Uint8Array(d),s=0;s<c.length;s++)r[s]=c.charCodeAt(s)&255;return d}function le(c){var d=ae().write({SheetNames:["sheet1"],Sheets:{sheet1:c}},{bookType:"xlsx",bookSST:!1,type:"binary"}),r=new Blob([re(d)],{type:"application/octet-stream"});return r}function ue(c){var d=le(c),r=URL.createObjectURL(d),s=document.createElement("a");s.href=r,s.download="".concat(Z()().format("YYYY_MM_DD"),".xlsx"),s.innerText="".concat(Z()().format("YYYY_MM_DD"),".xlsx"),s.click(),URL.revokeObjectURL(r)}var w=n(53759),u=n(85893),se=D.Z.TextArea,oe=P.utils.table_to_sheet,F=/MOMENT\(.+\)/g,j="TEMPLATE_CONFIG",O="TEMPLATE_AUTO",ie=function c(d){return d.map(function(r){return{title:r.title.replace(F,function(s){return Z()().format(s.slice(7,s.length-1))}),dataIndex:r.dataIndex,sorter:r.sorter?function(s,$){var S,C;return s[(S=r==null?void 0:r.dataIndex)!==null&&S!==void 0?S:0]-$[(C=r==null?void 0:r.dataIndex)!==null&&C!==void 0?C:0]}:void 0,children:r.children?c(r.children):void 0}})},ce=function(){var c=(0,a.useState)([]),d=(0,f.Z)(c,2),r=d[0],s=d[1],$=(0,a.useState)(""),S=(0,f.Z)($,2),C=S[0],de=S[1],ve=(0,a.useState)([]),V=(0,f.Z)(ve,2),N=V[0],fe=V[1],me=(0,a.useState)(!!localStorage.getItem(O)),G=(0,f.Z)(me,2),Y=G[0],he=G[1],pe=(0,a.useState)(""),H=(0,f.Z)(pe,2),y=H[0],J=H[1],ge=(0,a.useState)([]),K=(0,f.Z)(ge,2),T=K[0],xe=K[1],Se=(0,a.useState)([]),X=(0,f.Z)(Se,2),Ce=X[0],U=X[1],ye=(0,a.useState)([]),Q=(0,f.Z)(ye,2),Ie=Q[0],be=Q[1],W=(0,a.useRef)(),q=(0,a.useMemo)(function(){return N.length},[N]),m=(0,a.useMemo)(function(){return(0,B.Z)(new Array(q)).map(function(){return""})},[q]),Ee=(0,a.useState)(m),_=(0,f.Z)(Ee,2),h=_[0],R=_[1],Ae=(0,a.useMemo)(function(){return C.split(`
`).filter(Boolean).map(function(e){return e.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(t){return/\$\{[0-9]+\}/.test(t)?{type:"input",dataIndex:+t.slice(2,t.length-1)}:{type:"text",value:t}})})},[C]),Ze=(0,a.useCallback)(function(e){return function(t){R(m.map(function(l,v){var i;return v===e?t.target.value:(i=h==null?void 0:h[v])!==null&&i!==void 0?i:""}))}},[h,m]),je=(0,a.useCallback)(function(){xe([].concat((0,B.Z)(T),[h])),J(""),R(m),U([]),W.current.focus()},[T,m,h]),b=(0,a.useCallback)(function(){R(m),U([])},[m]),E=(0,a.useCallback)(function(e){var t=(0,B.Z)(m),l=[];N.forEach(function(v,i){var p,g;t[i]=(p=(g=e.replace(/\s/g,"").match(v))===null||g===void 0?void 0:g[1])!==null&&p!==void 0?p:"",t[i]||l.push(i)}),R(t),U(l)},[m,N]),Ne=(0,a.useCallback)(function(){var e=oe(document.getElementById("table"));ue(e)},[]),Te=(0,a.useCallback)(function(e){var t=e.target.checked;he(t),t?(localStorage.setItem(O,"1"),b(),y&&E(y)):localStorage.removeItem(O)},[b,E,y]),Re=(0,a.useCallback)(function(e){var t=e.target.value;J(t),Y&&(b(),t&&E(t))},[Y,b,E]),I=(0,a.useCallback)(function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!e||!e.wordTemplate||!e.columns||!e.parseRules?(L.default.error("\u914D\u7F6E\u6587\u4EF6\u4E0D\u6B63\u786E!"),localStorage.removeItem(j)):(localStorage.setItem(j,JSON.stringify(e)),de(e.wordTemplate.replace(F,function(l){return Z()().format(l.slice(7,l.length-1))})),s(ie(e.columns)),fe(e.parseRules.map(function(l){return new RegExp(l)})),t||L.default.success("\u5BFC\u5165\u914D\u7F6E\u6210\u529F!"))},[]),Me=(0,a.useCallback)(function(){var e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=function(t){var l,v,i=t==null||(l=t.target)===null||l===void 0||(v=l.files)===null||v===void 0?void 0:v[0];if(i){var p=new FileReader;p.onload=function(){var g=p.result;try{var Le=JSON.parse(g);I(Le)}catch(Ye){L.default.error("\u914D\u7F6E\u4E0D\u6B63\u786E!")}},p.readAsText(i,"UTF-8")}},e.click()},[I]);(0,a.useEffect)(function(){(0,w.Z)().then(function(e){var t=e.list;be(t)})},[]);var ke=(0,a.useCallback)(function(e){(0,w.Z)(e).then(I)},[I]);return(0,a.useEffect)(function(){try{var e=JSON.parse(localStorage.getItem(j));e&&I(e,!0)}catch(t){localStorage.removeItem(j)}},[I]),(0,u.jsxs)("div",{className:o().wrapper,children:[(0,u.jsxs)("div",{className:o().config,children:[(0,u.jsx)(x.Z,{size:"small",onClick:Me,children:"\u5BFC\u5165\u914D\u7F6E"}),Ie.map(function(e){var t=e.name,l=e.fileName;return(0,u.jsx)(x.Z,{size:"small",onClick:function(){return ke(l)},children:t},l)})]}),(0,u.jsxs)("div",{className:o().workArea,children:[(0,u.jsx)(se,{ref:W,autoFocus:!0,className:o().input,value:y,onChange:Re}),(0,u.jsxs)("div",{children:[(0,u.jsx)(x.Z,{className:o().btn,size:"small",type:"primary",onClick:function(){return E(y)},disabled:!y,children:"\u89E3\u6790\u2192"}),(0,u.jsx)(ee.Z,{className:o().btn,checked:Y,onChange:Te,children:"\u81EA\u52A8\u2192"})]}),(0,u.jsxs)("div",{className:o().parseResult,children:[Ae.map(function(e,t){return(0,u.jsx)("div",{className:o().row,children:e.map(function(l,v){var i=l.type,p=l.value,g=l.dataIndex;return(0,u.jsxs)(a.Fragment,{children:[i==="input"&&(0,u.jsx)(D.Z,{value:h[g],onChange:Ze(g),className:"".concat(o().templateInput," ").concat(Ce.includes(g)&&o().errInput),size:"small"}),i==="text"&&p]},"".concat(t,"_").concat(v))})},t)}),(0,u.jsxs)("div",{className:o().row,children:[(0,u.jsx)(x.Z,{size:"small",type:"primary",onClick:je,disabled:!h.filter(Boolean).length,children:"\u786E\u8BA4"}),(0,u.jsx)(x.Z,{size:"small",type:"primary",danger:!0,onClick:b,disabled:!h.filter(Boolean).length,children:"\u6E05\u7A7A"})]})]})]}),(0,u.jsx)(x.Z,{className:o().btn,size:"small",type:"primary",disabled:!T.length,onClick:Ne,children:"\u5BFC\u51FA"}),(0,u.jsx)(k.Z,{id:"table",className:o().table,columns:r,dataSource:T,bordered:!0,pagination:!1})]})}},18685:function(){},20067:function(){},55382:function(){},72095:function(){},61219:function(){}}]);
