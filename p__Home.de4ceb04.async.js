(self.webpackChunktest=self.webpackChunktest||[]).push([[371],{75941:function($){$.exports={wrapper:"wrapper___3iih1",workArea:"workArea___3Z94m",input:"input___3IKyb",parseResult:"parseResult___2m4fz",row:"row___35U44",templateInput:"templateInput___3qfFR",errInput:"errInput___2Sb3-",table:"table___3-dMD"}},66635:function($,R,r){"use strict";r.r(R),r.d(R,{default:function(){return q}});var pt=r(92157),L=r(22363),ht=r(57663),y=r(27884),j=r(86582),v=r(2824),xt=r(47673),M=r(20086),O=r(75941),c=r.n(O),a=r(67294),N=r(7869),H=r.n(N),P=r(30381),g=r.n(P);function G(s){for(var i=new ArrayBuffer(s.length),t=new Uint8Array(i),u=0;u<s.length;u++)t[u]=s.charCodeAt(u)&255;return i}function K(s){var i=H().write({SheetNames:["sheet1"],Sheets:{sheet1:s}},{bookType:"xlsx",bookSST:!1,type:"binary"}),t=new Blob([G(i)],{type:"application/octet-stream"});return t}function W(s){var i=K(s),t=URL.createObjectURL(i),u=document.createElement("a");u.href=t,u.download="".concat(g()().format("YYYY_MM_DD"),".xlsx"),u.innerText="".concat(g()().format("YYYY_MM_DD"),".xlsx"),u.click(),URL.revokeObjectURL(t)}var Z=function(s){var i="https://neco86.github.io/templateReport/config/".concat(s,".json?t=").concat(Date.now());return fetch(i).then(function(t){return t.json()}).then(function(t){return t.data})},o=r(85893),X=M.Z.TextArea,J=N.utils.table_to_sheet,w=/MOMENT\(.+\)/g,Q=function s(i){return i.map(function(t){return{title:t.title.replace(w,function(u){return g()().format(u.slice(7,u.length-1))}),dataIndex:t.dataIndex,sorter:t.sorter?function(u,E){var p,f;return u[(p=t==null?void 0:t.dataIndex)!==null&&p!==void 0?p:0]-E[(f=t==null?void 0:t.dataIndex)!==null&&f!==void 0?f:0]}:void 0,children:t.children?s(t.children):void 0}})},q=function(){var s=(0,a.useState)([]),i=(0,v.Z)(s,2),t=i[0],u=i[1],E=(0,a.useState)(""),p=(0,v.Z)(E,2),f=p[0],_=p[1],tt=(0,a.useState)([]),B=(0,v.Z)(tt,2),Y=B[0],et=B[1];(0,a.useEffect)(function(){Z("columns").then(function(e){u(Q(e))})},[]),(0,a.useEffect)(function(){Z("wordTemplate").then(function(e){_(e.replace(w,function(n){return g()().format(n.slice(7,n.length-1))}))})},[]),(0,a.useEffect)(function(){Z("parseRules").then(function(e){et(e.map(function(n){return new RegExp(n)}))})},[]);var nt=(0,a.useState)(""),D=(0,v.Z)(nt,2),C=D[0],z=D[1],at=(0,a.useState)([]),U=(0,v.Z)(at,2),I=U[0],rt=U[1],ut=(0,a.useState)([]),F=(0,v.Z)(ut,2),lt=F[0],A=F[1],ot=(0,a.useCallback)(function(e){z(e.target.value)},[]),st=(0,a.useMemo)(function(){return f.split(`
`).filter(Boolean).map(function(e){return e.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(n){return/\$\{[0-9]+\}/.test(n)?{type:"input",dataIndex:+n.slice(2,n.length-1)}:{type:"text",value:n}})})},[f]),V=(0,a.useMemo)(function(){var e,n;return((e=(n=f.split(/(\$\{[0-9]+\})/g).filter(function(l){return/\$\{[0-9]+\}/.test(l)}).map(function(l){return+l.slice(2,l.length-1)}).sort(function(l,d){return d-l}))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:-1)+1},[f]),m=(0,a.useMemo)(function(){return(0,j.Z)(new Array(V)).map(function(){return""})},[V]),it=(0,a.useState)(m),k=(0,v.Z)(it,2),x=k[0],b=k[1],ct=(0,a.useCallback)(function(e){return function(n){b(x.map(function(l,d){return d===e?n.target.value:l}))}},[x]),dt=(0,a.useCallback)(function(){rt([].concat((0,j.Z)(I),[x])),z(""),b(m),A([])},[I,m,x]),ft=(0,a.useCallback)(function(){b(m),A([])},[m]),vt=(0,a.useCallback)(function(){var e=(0,j.Z)(m),n=[];Y.forEach(function(l,d){var h,S;e[d]=(h=(S=C.replace(/\s/g,"").match(l))===null||S===void 0?void 0:S[1])!==null&&h!==void 0?h:"",e[d]||n.push(d)}),b(e),A(n)},[m,C,Y]),mt=(0,a.useCallback)(function(){var e=J(document.getElementById("table"));W(e)},[]);return(0,o.jsxs)("div",{className:c().wrapper,children:[(0,o.jsxs)("div",{className:c().workArea,children:[(0,o.jsx)(X,{autoFocus:!0,className:c().input,value:C,onChange:ot}),(0,o.jsx)(y.Z,{size:"small",type:"primary",onClick:vt,disabled:!C,children:"\u89E3\u6790\u2192"}),(0,o.jsxs)("div",{className:c().parseResult,children:[st.map(function(e,n){return(0,o.jsx)("div",{className:c().row,children:e.map(function(l,d){var h=l.type,S=l.value,T=l.dataIndex;return(0,o.jsxs)(a.Fragment,{children:[h==="input"&&(0,o.jsx)(M.Z,{value:x[T],onChange:ct(T),className:"".concat(c().templateInput," ").concat(lt.includes(T)&&c().errInput),size:"small"}),h==="text"&&S]},"".concat(n,"_").concat(d))})},n)}),(0,o.jsxs)("div",{className:c().row,children:[(0,o.jsx)(y.Z,{size:"small",type:"primary",onClick:dt,children:"\u786E\u8BA4"}),(0,o.jsx)(y.Z,{size:"small",type:"primary",danger:!0,onClick:ft,children:"\u6E05\u7A7A"})]})]})]}),(0,o.jsx)(y.Z,{size:"small",type:"primary",disabled:!I.length,onClick:mt,children:"\u5BFC\u51FA"}),(0,o.jsx)(L.Z,{id:"table",className:c().table,columns:t,dataSource:I,bordered:!0,pagination:!1})]})}},18685:function(){},20067:function(){},55382:function(){},72095:function(){},61219:function(){}}]);
