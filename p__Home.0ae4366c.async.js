(self.webpackChunktest=self.webpackChunktest||[]).push([[371],{75941:function(e){e.exports={wrapper:"wrapper___3iih1",workArea:"workArea___3Z94m",input:"input___3IKyb",parseResult:"parseResult___2m4fz",row:"row___35U44",templateInput:"templateInput___3qfFR",errInput:"errInput___2Sb3-",table:"table___3-dMD"}},53759:function(e,t){"use strict";t.Z=function(_){return fetch("https://raw.githubusercontent.com/Neco86/templateReport/main/config/".concat(_,".js")).then(function(a){return a.text()})}},83173:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var antd_es_table_style__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(92157),antd_es_table__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(22363),antd_es_button_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(57663),antd_es_button__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(27884),_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(86582),_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2824),antd_es_input_style__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(47673),antd_es_input__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(20086),_index_less_modules__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(75941),_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_index_less_modules__WEBPACK_IMPORTED_MODULE_3__),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(67294),xlsx__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7869),xlsx__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(xlsx__WEBPACK_IMPORTED_MODULE_5__),_utils_download__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(49533),moment__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(30381),moment__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_7__),_fetchConfig__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(53759),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(85893),TextArea=antd_es_input__WEBPACK_IMPORTED_MODULE_9__.Z.TextArea,tableToSheet=xlsx__WEBPACK_IMPORTED_MODULE_5__.utils.table_to_sheet;window.moment=moment__WEBPACK_IMPORTED_MODULE_7___default(),__webpack_exports__.default=function(){var _useState=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState2=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState,2),columns=_useState2[0],setColumns=_useState2[1],_useState3=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(""),_useState4=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState3,2),wordTemplate=_useState4[0],setWordTemplate=_useState4[1],_useState5=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState6=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState5,2),parseRules=_useState6[0],setParseRules=_useState6[1];(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function(){(0,_fetchConfig__WEBPACK_IMPORTED_MODULE_11__.Z)("columns").then(function(res){setColumns(eval(res))})},[]),(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function(){(0,_fetchConfig__WEBPACK_IMPORTED_MODULE_11__.Z)("wordTemplate").then(function(res){setWordTemplate(eval(res))})},[]),(0,react__WEBPACK_IMPORTED_MODULE_4__.useEffect)(function(){(0,_fetchConfig__WEBPACK_IMPORTED_MODULE_11__.Z)("parseRules").then(function(res){setParseRules(eval(res))})},[]);var _useState7=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(""),_useState8=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState7,2),input=_useState8[0],setInput=_useState8[1],_useState9=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState10=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState9,2),dataSource=_useState10[0],setDataSource=_useState10[1],_useState11=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)([]),_useState12=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState11,2),errIndex=_useState12[0],setErrIndex=_useState12[1],handleInputChange=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(e){setInput(e.target.value)},[]),renderTemplate=(0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(function(){return wordTemplate.split(`
`).filter(Boolean).map(function(e){return e.split(/(\$\{[0-9]+\})/g).filter(Boolean).map(function(t){return/\$\{[0-9]+\}/.test(t)?{type:"input",dataIndex:+t.slice(2,t.length-1)}:{type:"text",value:t}})})},[wordTemplate]),inputCounts=(0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(function(){var e,t;return((e=(t=wordTemplate.split(/(\$\{[0-9]+\})/g).filter(function(_){return/\$\{[0-9]+\}/.test(_)}).map(function(_){return+_.slice(2,_.length-1)}).sort(function(_,a){return a-_}))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:-1)+1},[wordTemplate]),initInputValues=(0,react__WEBPACK_IMPORTED_MODULE_4__.useMemo)(function(){return(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_12__.Z)(new Array(inputCounts)).map(function(){return""})},[inputCounts]),_useState13=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(initInputValues),_useState14=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_10__.Z)(_useState13,2),inputValues=_useState14[0],setInputValues=_useState14[1],handleInputValueChange=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(e){return function(t){setInputValues(inputValues.map(function(_,a){return a===e?t.target.value:_}))}},[inputValues]),handleSure=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(){setDataSource([].concat((0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_12__.Z)(dataSource),[inputValues])),setInput(""),setInputValues(initInputValues),setErrIndex([])},[dataSource,initInputValues,inputValues]),handleClear=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(){setInputValues(initInputValues),setErrIndex([])},[initInputValues]),handleParse=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(){var e=(0,_Users_caoweiwei_Workspace_number_spilt_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_12__.Z)(initInputValues),t=[];parseRules.forEach(function(_,a){var s,u;e[a]=(s=(u=input.replace(/\s/g,"").match(_))===null||u===void 0?void 0:u[1])!==null&&s!==void 0?s:"",e[a]||t.push(a)}),setInputValues(e),setErrIndex(t)},[initInputValues,input,parseRules]),handleExport=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)(function(){var e=tableToSheet(document.getElementById("table"));(0,_utils_download__WEBPACK_IMPORTED_MODULE_6__.Z)(e)},[]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().wrapper,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().workArea,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(TextArea,{autoFocus:!0,className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().input,value:input,onChange:handleInputChange}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_13__.Z,{size:"small",type:"primary",onClick:handleParse,disabled:!input,children:"\u89E3\u6790\u2192"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().parseResult,children:[renderTemplate.map(function(e,t){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)("div",{className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().row,children:e.map(function(_,a){var s=_.type,u=_.value,E=_.dataIndex;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)(react__WEBPACK_IMPORTED_MODULE_4__.Fragment,{children:[s==="input"&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_input__WEBPACK_IMPORTED_MODULE_9__.Z,{value:inputValues[E],onChange:handleInputValueChange(E),className:"".concat(_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().templateInput," ").concat(errIndex.includes(E)&&_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().errInput),size:"small"}),s==="text"&&u]},"".concat(t,"_").concat(a))})},t)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsxs)("div",{className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().row,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_13__.Z,{size:"small",type:"primary",onClick:handleSure,children:"\u786E\u8BA4"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_13__.Z,{size:"small",type:"primary",danger:!0,onClick:handleClear,children:"\u6E05\u7A7A"})]})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_button__WEBPACK_IMPORTED_MODULE_13__.Z,{size:"small",type:"primary",disabled:!dataSource.length,onClick:handleExport,children:"\u5BFC\u51FA"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(antd_es_table__WEBPACK_IMPORTED_MODULE_14__.Z,{id:"table",className:_index_less_modules__WEBPACK_IMPORTED_MODULE_3___default().table,columns,dataSource,bordered:!0})]})}},49533:function(e,t,_){"use strict";_.d(t,{Z:function(){return d}});var a=_(30381),s=_.n(a),u=_(7869),E=_.n(u);function o(n){for(var l=new ArrayBuffer(n.length),i=new Uint8Array(l),r=0;r<n.length;r++)i[r]=n.charCodeAt(r)&255;return l}function c(n){var l=E().write({SheetNames:["sheet1"],Sheets:{sheet1:n}},{bookType:"xlsx",bookSST:!1,type:"binary"}),i=new Blob([o(l)],{type:"application/octet-stream"});return i}function d(n){var l=c(n),i=URL.createObjectURL(l),r=document.createElement("a");r.href=i,r.download="".concat(s()().format("YYYY_MM_DD"),".xlsx"),r.innerText="".concat(s()().format("YYYY_MM_DD"),".xlsx"),r.click()}},18685:function(){},20067:function(){},55382:function(){},72095:function(){},61219:function(){}}]);
